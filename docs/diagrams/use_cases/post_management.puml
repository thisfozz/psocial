@startuml post_management

!include uc_styles.puml

actor "Пользователь" as user
rectangle "Система" as system
database "База данных" as db

rectangle "Управление постами" {
    usecase "Просмотр списка постов" as UC1 #BBDEFB
    usecase "Написать пост" as UC2 #BBDEFB
    usecase "Отправить пост" as UC3 #BBDEFB
    usecase "Редактировать пост" as UC4 #BBDEFB
    usecase "Удалить пост" as UC5 #BBDEFB
    usecase "Поставить лайк" as UC6 #BBDEFB
    usecase "Удалить лайк" as UC7 #BBDEFB

    usecase "Загрузить посты" as S0 #C8E6C9
    usecase "Проверить данные" as S1 #C8E6C9
    usecase "Сохранить пост" as S3 #C8E6C9
    usecase "Обновить пост" as S4 #C8E6C9
    usecase "Удалить запись" as S5 #C8E6C9
    usecase "Добавить лайк" as S6 #C8E6C9
    usecase "Удалить лайк" as S7 #C8E6C9

    usecase "Показать ошибку" as S2 #FFCDD2

    user -[#1976D2]-> UC1 : Шаг 1A
    UC1 -[#1976D2]-> system : запрос
    system -[#388E3C]-> S0 : Шаг 2A
    system -[#388E3C]-> user : отображение постов

    user -[#1976D2]-> UC2 : Шаг 1B
    UC2 -[#1976D2]-> UC3 : Шаг 2B
    UC3 -[#1976D2]-> system : отправка
    system -[#388E3C]-> S1 : Шаг 3B
    system -[#388E3C]-> S3 : Шаг 4B (если валидно)
    system -[#D32F2F]-> S2 : при ошибке
    system -[#D32F2F]-> user : сообщение об ошибке

    user -[#1976D2]-> UC4 : Шаг 1C
    UC4 -[#1976D2]-> system : отправка изменений
    system -[#388E3C]-> S1 : Шаг 2C
    system -[#388E3C]-> S4 : Шаг 3C (если валидно)

    user -[#1976D2]-> UC5 : Шаг 1D
    UC5 -[#1976D2]-> system : запрос на удаление
    system -[#388E3C]-> S5 : Шаг 2D

    user -[#1976D2]-> UC6 : Шаг 1E
    UC6 -[#1976D2]-> system : запрос
    system -[#388E3C]-> S6 : Шаг 2E

    user -[#1976D2]-> UC7 : Шаг 1F
    UC7 -[#1976D2]-> system : запрос
    system -[#388E3C]-> S7 : Шаг 2F

    system -[#388E3C]-> db : взаимодействие с БД

    note right of UC1 #FFF8E1
        <b>Сценарий A: Просмотр постов</b>
        <b>Шаг 1A:</b> Пользователь открывает
        страницу со списком постов
        (лента, профиль и т.д.)
    end note

    note right of UC2 #FFF8E1
        <b>Сценарий B: Создание поста</b>
        <b>Шаг 1B-2B:</b> Пользователь создает
        новый пост и отправляет его.
        Пост может оставить только
        авторизованный пользователь.
        Пост не может быть пустым.
    end note

    note right of UC4 #FFF8E1
        <b>Сценарий C: Редактирование</b>
        <b>Шаг 1C:</b> Пользователь может
        редактировать только свой пост.
        Система проверяет права доступа.
    end note

    note right of UC5 #FFF8E1
        <b>Сценарий D: Удаление</b>
        <b>Шаг 1D:</b> Пользователь может
        удалить только свой пост.
        Система проверяет права доступа.
    end note

    note right of UC6 #FFF8E1
        <b>Сценарий E: Лайк</b>
        <b>Шаг 1E:</b> Пользователь может поставить
        только один лайк на пост.
        Система проверяет наличие
        существующего лайка.
    end note

    note right of UC7 #FFF8E1
        <b>Сценарий F: Удаление лайка</b>
        <b>Шаг 1F:</b> Пользователь может
        удалить только свой лайк.
        Система проверяет права доступа.
    end note

    ' Заметки для системных действий
    note bottom of S1 #FFF8E1
        <b>Проверка данных:</b>
        • Авторизован ли пользователь
        • Не пустой ли контент
        • Права на редактирование/удаление
        • Корректность формата данных
    end note

    note bottom of S2 #FFF9C4
        <b>Обработка ошибок:</b>
        • Пользователь не авторизован
        • Пустой контент поста
        • Нет прав на действие
        • Пост не найден
        • Лайк уже существует
    end note

    note bottom of S3 #FFF8E1
        <b>Сохранение поста:</b>
        • Запись в таблицу posts
        • Обработка медиафайлов
        • Обновление счетчиков
    end note

    note bottom of db #FFF8E1
        <b>Операции с базой данных:</b>
        • Чтение данных (загрузка постов)
        • Создание записей (новые посты, лайки)
        • Обновление записей (редактирование)
        • Удаление записей (удаление постов, лайков)
    end note
}

caption "Диаграмма процесса управления постами в системе PSocial"

@enduml
